import numpy as np
from max_mutual_info import run_BnB

def test_solve_full_depth_no_rounding():
    Sigma = np.array([[15.62448712,  6.43476875,  1.7402775 , -0.54443146,  1.61801633,
         1.17943497,  0.43056112,  2.84162831,  2.73130957,  4.16481826],
       [ 6.43476875, 18.84469145,  1.92930185,  0.9819152 ,  1.77140734,
         1.1260375 ,  3.88613766,  4.24965465,  2.83933176,  0.49292439],
       [ 1.7402775 ,  1.92930185,  6.08894124, -2.39329547, -7.55280109,
        -1.9967024 , -0.39894641, -3.48180345, -1.15409563, -1.52329834],
       [-0.54443146,  0.9819152 , -2.39329547,  5.60786611,  1.04821066,
        -0.79162096, -0.68802147,  0.41503972, -0.46191569, -0.56307753],
       [ 1.61801633,  1.77140734, -7.55280109,  1.04821066, 16.81831927,
         4.47855568,  6.17639248,  8.14570848,  2.93609507,  2.35402102],
       [ 1.17943497,  1.1260375 , -1.9967024 , -0.79162096,  4.47855568,
         2.82546226,  1.49880685,  2.6094296 ,  1.17133454,  0.89314619],
       [ 0.43056112,  3.88613766, -0.39894641, -0.68802147,  6.17639248,
         1.49880685,  9.16239386,  6.7984268 ,  2.28639733, -0.6755114 ],
       [ 2.84162831,  4.24965465, -3.48180345,  0.41503972,  8.14570848,
         2.6094296 ,  6.7984268 , 12.2863359 ,  3.41007227,  3.33537858],
       [ 2.73130957,  2.83933176, -1.15409563, -0.46191569,  2.93609507,
         1.17133454,  2.28639733,  3.41007227,  2.2688612 ,  1.58382392],
       [ 4.16481826,  0.49292439, -1.52329834, -0.56307753,  2.35402102,
         0.89314619, -0.6755114 ,  3.33537858,  1.58382392,  3.9312566 ]])
    out = run_BnB(Sigma, 5, .01, 100000, 0, 'log_full_depth_no_rounding.txt', 0)
    return out

def test_solve_full_depth_with_rounding():
    Sigma = np.array([[15.62448712,  6.43476875,  1.7402775 , -0.54443146,  1.61801633,
         1.17943497,  0.43056112,  2.84162831,  2.73130957,  4.16481826],
       [ 6.43476875, 18.84469145,  1.92930185,  0.9819152 ,  1.77140734,
         1.1260375 ,  3.88613766,  4.24965465,  2.83933176,  0.49292439],
       [ 1.7402775 ,  1.92930185,  6.08894124, -2.39329547, -7.55280109,
        -1.9967024 , -0.39894641, -3.48180345, -1.15409563, -1.52329834],
       [-0.54443146,  0.9819152 , -2.39329547,  5.60786611,  1.04821066,
        -0.79162096, -0.68802147,  0.41503972, -0.46191569, -0.56307753],
       [ 1.61801633,  1.77140734, -7.55280109,  1.04821066, 16.81831927,
         4.47855568,  6.17639248,  8.14570848,  2.93609507,  2.35402102],
       [ 1.17943497,  1.1260375 , -1.9967024 , -0.79162096,  4.47855568,
         2.82546226,  1.49880685,  2.6094296 ,  1.17133454,  0.89314619],
       [ 0.43056112,  3.88613766, -0.39894641, -0.68802147,  6.17639248,
         1.49880685,  9.16239386,  6.7984268 ,  2.28639733, -0.6755114 ],
       [ 2.84162831,  4.24965465, -3.48180345,  0.41503972,  8.14570848,
         2.6094296 ,  6.7984268 , 12.2863359 ,  3.41007227,  3.33537858],
       [ 2.73130957,  2.83933176, -1.15409563, -0.46191569,  2.93609507,
         1.17133454,  2.28639733,  3.41007227,  2.2688612 ,  1.58382392],
       [ 4.16481826,  0.49292439, -1.52329834, -0.56307753,  2.35402102,
         0.89314619, -0.6755114 ,  3.33537858,  1.58382392,  3.9312566 ]])
    out = run_BnB(Sigma, 5, .01, 100000, 100, 'log_full_depth_with_rounding.txt', 0)
    return out

def test_solve_low_depth_no_rounding():
    Sigma = np.array([[15.62448712,  6.43476875,  1.7402775 , -0.54443146,  1.61801633,
         1.17943497,  0.43056112,  2.84162831,  2.73130957,  4.16481826],
       [ 6.43476875, 18.84469145,  1.92930185,  0.9819152 ,  1.77140734,
         1.1260375 ,  3.88613766,  4.24965465,  2.83933176,  0.49292439],
       [ 1.7402775 ,  1.92930185,  6.08894124, -2.39329547, -7.55280109,
        -1.9967024 , -0.39894641, -3.48180345, -1.15409563, -1.52329834],
       [-0.54443146,  0.9819152 , -2.39329547,  5.60786611,  1.04821066,
        -0.79162096, -0.68802147,  0.41503972, -0.46191569, -0.56307753],
       [ 1.61801633,  1.77140734, -7.55280109,  1.04821066, 16.81831927,
         4.47855568,  6.17639248,  8.14570848,  2.93609507,  2.35402102],
       [ 1.17943497,  1.1260375 , -1.9967024 , -0.79162096,  4.47855568,
         2.82546226,  1.49880685,  2.6094296 ,  1.17133454,  0.89314619],
       [ 0.43056112,  3.88613766, -0.39894641, -0.68802147,  6.17639248,
         1.49880685,  9.16239386,  6.7984268 ,  2.28639733, -0.6755114 ],
       [ 2.84162831,  4.24965465, -3.48180345,  0.41503972,  8.14570848,
         2.6094296 ,  6.7984268 , 12.2863359 ,  3.41007227,  3.33537858],
       [ 2.73130957,  2.83933176, -1.15409563, -0.46191569,  2.93609507,
         1.17133454,  2.28639733,  3.41007227,  2.2688612 ,  1.58382392],
       [ 4.16481826,  0.49292439, -1.52329834, -0.56307753,  2.35402102,
         0.89314619, -0.6755114 ,  3.33537858,  1.58382392,  3.9312566 ]])
    out = run_BnB(Sigma, 5, .01, 6, 0, 'log_low_depth_no_rounding.txt', 0)
    out = run_BnB(Sigma, 5, .01, 6, 0, 'log_low_depth_no_rounding.txt', 1)
    out = run_BnB(Sigma, 5, .01, 6, 0, 'log_low_depth_no_rounding.txt', 2)
    out = run_BnB(Sigma, 5, .01, 6, 0, 'log_low_depth_no_rounding.txt', 3)
    return out

def test_solve_low_depth_with_rounding():
    Sigma = np.array([[15.62448712,  6.43476875,  1.7402775 , -0.54443146,  1.61801633,
         1.17943497,  0.43056112,  2.84162831,  2.73130957,  4.16481826],
       [ 6.43476875, 18.84469145,  1.92930185,  0.9819152 ,  1.77140734,
         1.1260375 ,  3.88613766,  4.24965465,  2.83933176,  0.49292439],
       [ 1.7402775 ,  1.92930185,  6.08894124, -2.39329547, -7.55280109,
        -1.9967024 , -0.39894641, -3.48180345, -1.15409563, -1.52329834],
       [-0.54443146,  0.9819152 , -2.39329547,  5.60786611,  1.04821066,
        -0.79162096, -0.68802147,  0.41503972, -0.46191569, -0.56307753],
       [ 1.61801633,  1.77140734, -7.55280109,  1.04821066, 16.81831927,
         4.47855568,  6.17639248,  8.14570848,  2.93609507,  2.35402102],
       [ 1.17943497,  1.1260375 , -1.9967024 , -0.79162096,  4.47855568,
         2.82546226,  1.49880685,  2.6094296 ,  1.17133454,  0.89314619],
       [ 0.43056112,  3.88613766, -0.39894641, -0.68802147,  6.17639248,
         1.49880685,  9.16239386,  6.7984268 ,  2.28639733, -0.6755114 ],
       [ 2.84162831,  4.24965465, -3.48180345,  0.41503972,  8.14570848,
         2.6094296 ,  6.7984268 , 12.2863359 ,  3.41007227,  3.33537858],
       [ 2.73130957,  2.83933176, -1.15409563, -0.46191569,  2.93609507,
         1.17133454,  2.28639733,  3.41007227,  2.2688612 ,  1.58382392],
       [ 4.16481826,  0.49292439, -1.52329834, -0.56307753,  2.35402102,
         0.89314619, -0.6755114 ,  3.33537858,  1.58382392,  3.9312566 ]])
    out = run_BnB(Sigma, 5, .01, 6, 1000, 'log_low_depth_with_rounding.txt', 0)
    out = run_BnB(Sigma, 5, .01, 6, 1000, 'log_low_depth_with_rounding.txt', 1)
    out = run_BnB(Sigma, 5, .01, 6, 1000, 'log_low_depth_with_rounding.txt', 2)
    out = run_BnB(Sigma, 5, .01, 6, 1000, 'log_low_depth_with_rounding.txt', 3)
    return out


if __name__ == '__main__':
#    test_solve_full_depth_no_rounding()
#    test_solve_full_depth_with_rounding()
    test_solve_low_depth_no_rounding()
    test_solve_low_depth_with_rounding()

